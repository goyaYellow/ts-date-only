import { DateOnly } from "../lib/date-only";

describe("ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿", () => {
  describe("æ­£å¸¸ç³»", () => {
    describe.each([
      [2022, 1, 1],
      [2020, 2, 29], // ã†ã‚‹ã†å¹´
    ])(
      `å¹´æœˆæ—¥ã¨ã—ã¦æ­£å¸¸ãªå€¤ã‚’æ¸¡ã•ã‚ŒãŸå ´åˆã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ãã‚‹!`,
      (year, month, day) => {
        test(`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ãã‚‹!${year}/${month}/${day}`, () => {
          expect(new DateOnly(year, month, day)).toBeInstanceOf(DateOnly);
        });
      }
    );
  });

  describe("ç•°å¸¸ç³»", () => {
    describe.each([
      [-2022, 1, 1],
      [2020, -1, 1],
      [2020, 1, -1],
    ])(
      "å¹´æœˆæ—¥ã¨ã—ã¦ç•°å¸¸ãªå€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹",
      (year, month, day) => {
        test(`å¹´æœˆæ—¥ã¨ã—ã¦ç•°å¸¸ãªå€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹${year}/${month}/${day}`, () => {
          expect(() => {
            new DateOnly(year, month, day);
          }).toThrowError(Error);
        });
      }
    );

    describe.each([
      [2021, 2, 29], // ã†ã‚‹ã†å¹´ã˜ã‚ƒãªã„
      [2100, 2, 29], // ã†ã‚‹ã†å¹´ã˜ã‚ƒãªã„
      [1, 1, 1],
    ])(
      "å­˜åœ¨ã—å¾—ãªã„å¹´æœˆæ—¥ãŒå€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹",
      (year, month, day) => {
        test(`å­˜åœ¨ã—å¾—ãªã„å¹´æœˆæ—¥ãŒå€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã€‚${year}/${month}/${day}`, () => {
          expect(() => {
            new DateOnly(year, month, day);
          }).toThrowError(Error);
        });
      }
    );
  });
});

describe("ãƒ•ã‚¡ã‚¯ãƒˆãƒªç³»", () => {
  describe("æ–‡å­—åˆ—ã‚’å…ƒã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°ã®ãƒ†ã‚¹ãƒˆ", () => {
    test("ã‚¹ãƒ©ãƒƒã‚·ãƒ¥åŒºåˆ‡ã‚Šã®å¹´æœˆæ—¥å½¢å¼ã®æ–‡å­—åˆ—ã‚’æ¸¡ã—ã¦ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ãªã‘ã‚Œã°ã€æ–‡å­—åˆ—ã§ç¤ºã—ãŸå¹´æœˆæ—¥ã‚’ç¤ºã™ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒðŸ¸", () => {
      // æº–å‚™
      const source = "2022/01/02";
      const expected = new DateOnly(2022, 1, 2);

      // å®Ÿè¡Œ
      const actual = DateOnly.fromByStr(source);

      // æ¤œè¨¼
      expect(actual.equals(expected)).toBe(false);
    });
  });
});
